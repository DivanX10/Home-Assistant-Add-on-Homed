Создайте папку `homed` в сетевой папке `config`, там где лежат другие конфигурационные файлы, например `configuration.yaml`. Внутри папки `homed` создайте файл с именем `homed-zigbee.conf` и добавьте параметры ниже

# Пример конфигурации

```
[mqtt]
host=core-mosquitto
port=1883
username=mqtt
password=mqtt
prefix=homed
names=true

[homeassistant]
enabled=true
prefix=homeassistant
status=homeassistant/status

[device]
database=/etc/homed/database.json
properties=/etc/homed/properties.json
options=/etc/homed/options.json
external=/etc/homed/library
offsets=true

[zigbee]
adapter=znp
baudrate=115200
port=/dev/ttyUSB0
panid=0x1010
channel=11
reset=soft
write=false

[security]
enabled=true
key=0x000102030405060708090a0b0c0d0e0f

[debug]
port=false
adapter=false
zigbee=false

[log]
enabled=true
file=/var/log/homed.log
```


# Параметры
 
## mqtt
| Параметры             | Описание                                            |
| --------------------- | ----------------------------------------------------|
| `host` | адрес брокера |
| `port` | порт брокера  |
| `username` | имя пользователя для авторизации на брокере (может быть пустым) |
| `password` |	пароль для авторизации на брокере (может быть пустым) |
| `prefix` |	корневой топик |
| `names` |	использование имен устройств вместо адресов в топиках homed/fd/zigbee |

## homeassistant
| Параметры             | Описание                                            |
| --------------------- | ----------------------------------------------------|
| `enabled` |	включение/выключение функции Home Assistant MQTT Discovery |
| `prefix` |	корневой топик для Home Assistant MQTT Discovery |
| `status` |	топик для отслеживания состояния Home Assistant |

## device
| Параметры             | Описание                                            |
| --------------------- | ----------------------------------------------------|
| `library` |	путь к файлу библиотеки устройств |
| `database` |	путь к файлу базы данных |
| `properties` |	путь к файлу, в котором будут храниться текущие свойства устройств |
| `options` |	путь к файлу настройки индивидуальных опций устройств |
| `external` |	путь к директории пользовательских расширений библиотеки устройств |
| `offsets` |	включение/выключение использования опций корркетировки показателей |

## gpio
| Параметры             | Описание                                            |
| --------------------- | ----------------------------------------------------|
| `status` |	порт светодиода для индикации режима добавления устройств |
| `blink` |	порт светодиода для индикации активности в сети |
| `boot` |	порт, к которому подключен вывод управления загрузчиком координатора |
| `reset` |	порт, к которому подключен вывод управления перезагрузкой координатора |

## zigbee
| Параметры             | Описание                                            |
| --------------------- | ----------------------------------------------------|
| `adapter` |	тип адаптера, возможные значения: ezsp, zigate, znp |
| `port` |	последовательный порт, к которому подключен координатор или адрес для сетевого подключения |
| `baudrate` |	скорость последовательного порта (при локальном подключении) |
| `panid` |	идентификатор сети (в шестнадцатеричом формате, 2 байта) |
| `channel` |	номер канала ZigBee |
| `reset` |	способ управления перезагрузкой координатора, возможные значения: gpio, flow, soft |
| `write` |	разрешение/запрет перезаписывать конфигурацию координатора, подробнее [здесь](https://wiki.homed.dev/page/ZigBee/Configuration#Конфигурация_координатора) |

## security
| Параметры             | Описание                                            |
| --------------------- | ----------------------------------------------------|
| `enabled` |	включение/выключение использования ключа сети |
| `key` |	ключ сети (в шестнадцатеричом формате, 16 байт) |

## debug
| Параметры             | Описание                                            |
| --------------------- | ----------------------------------------------------|
| `port` |	вывод в лог дампов данных последовательного порта |
| `adapter` |	вывод в лог дампов обмена данными с координатором |
| `zigbee` |	вывод в лог дампов входящих данных от устройств |

## log
| Параметры             | Описание                                            |
| --------------------- | ----------------------------------------------------|
| `enabled`             | включение/выключение записи логов в файл  |
| `file`                | путь к файлу лога                         |

# GPIO

Управление GPIO осуществляется через драйвер /sys/class/gpio.

В качестве значения для каждого параметра в секции [gpio] может быть указан либо номер порта, либо путь к файлу управления портом, например: /sys/class/gpio/gpio32/value. Если используется путь к файлу управления, порт должен быть заведомо инициализирован.

Параметры status и blink могут содержать одинаковое значение, в этом случае для обоих функций будет использоваться один и тот же светодиод.

В случае, когда управление GPIO не поддерживается системой или просто не требуется, нужно либо указать значение -1 для ненужного порта, либо удалить из файла конфигурации соответствующие строки.

# Сетевое подключение

HOMEd ZigBee поддерживает работу с координатором по сети, через TCP сокет, например, через ser2net в режиме RAW.

Для использования этой функции в качестве значения параметра port в секции [zigbee] нужно указать строку в формате `tcp://address:port`, например:

### zigbee

```
port=tcp://192.168.1.23:4832
```
